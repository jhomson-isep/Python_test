<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_home_menu_documents" name="Portal layout : document menu entries"
              inherit_id="portal.portal_breadcrumbs" priority="20">
        <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
            <li t-if="page_name in ['documents', 'update_document', 'create_document'] or documents"
                t-attf-class="breadcrumb-item #{'active ' if not documents else ''}">
                <a t-attf-href="/my/documents">Documentation</a>

            </li>
            <li t-if="document" class="breadcrumb-item active">
                <span t-field="document.document_type_id.name"/> -
                <t t-esc="document.document_name"/>
            </li>
            <li t-if="page_name in ['create_document']" class="breadcrumb-item active">
                <span>Uploading file</span>
            </li>
            <li t-if="page_name in ['documents', 'update_document']" class="breadcrumb-item">
                <a t-attf-class="btn btn-sm btn-primary" t-attf-href="/my/documents/create">New file</a>
            </li>
        </xpath>
    </template>

    <template id="portal_my_home_documents" name="Portal My Home : documents entries"
              inherit_id="portal.portal_my_home" priority="100">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="documents_count" t-call="portal.portal_docs_entry">
                <t t-set="title">Documentation</t>
                <t t-set="url" t-value="'/my/documents'"/>
                <t t-set="count" t-value="documents_count"/>
            </t>
        </xpath>
    </template>

    <template id="my_documentation_link" name="Link to frontend portal" inherit_id="portal.frontend_layout">
        <xpath expr="//a[@id='o_logout']" position="before">
            <a href="/my/gdrive/documents" role="menuitem" class="dropdown-item">My Documentation</a>
        </xpath>
    </template>

    <template id="portal_my_documents" name="My Documents">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">Documentation</t>
            </t>
            <t t-if="not documents">
                <p>There are currently no documentation for your account.</p>
            </t>
            <t t-if="documents" t-call="portal.portal_table">
                <thead>
                    <tr class="active">
                        <th>Document #</th>
                        <th class="text-right">Document name</th>
                        <th class="text-right">Document Type</th>
                        <th class="text-right">Actions</th>
                    </tr>
                </thead>
                <t t-foreach="documents" t-as="document">
                    <tr>
                        <td><a t-att-href="document.get_portal_url()">DOC-<t
                                t-esc="document.document_type_id.name"/>-<span t-field="document.id"/></a></td>
                        <td class="text-right"><a t-att-href="document.get_portal_url()"><t
                                t-esc="document.document_name"/></a></td>
                        <td class="text-right"><span t-field="document.document_type_id"/></td>
                        <th class="text-right">
                            <a t-attf-class="btn btn-sm btn-outline-primary"
                               t-attf-href="/my/documents/update/{{ document.id }}">Change</a>
                            <a t-attf-class="btn btn-sm btn-outline-danger"
                               t-attf-href="/my/documents/download/{{ document.id }}">Download</a>
                        </th>
                    </tr>
                </t>
            </t>
        </t>
    </template>

    <template id="op_gdrive_documentation">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Your Documentation Details</t>
            <h3>Your Documentation</h3>
            <div class="row">
                <div class="o_portal_my_details col-8">
                    <div class="row">
                        <div class="col-12">
                            <table t-attf-class="table table-light o_portal_my_details">
                                <thead>
                                    <tr>
                                        <th scope="col">Document Type</th>
                                        <th scope="col">Document Name</th>
                                        <th scope="col">Actions</th>
                                        <!--                              <th scope="col">Download</th>-->
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="document_count &gt; 0">
                                        <t t-foreach="partner.document_ids" t-as="document">
                                            <tr>
                                                <th scope="row"><a t-attf-class="btn btn-outline-primary"
                                                                   t-attf-href="/my/gdrive/update/{{ document.id }}"><t
                                                        t-esc="document.document_type_id.name"></t></a></th>
                                                <td><t t-esc="document.document_name"></t></td>
                                                <td><a t-attf-class="btn btn-primary" t-attf-href="/my/gdrive/download/?doc_id={{ document.id }}" name="download_file"  type="object" target="_blank" >Download</a></td>
                                            </tr>
                                        </t>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-4 rounded"
                     style="height:100%;background-color:white;padding-top:10px;padding-bottom:10px;">
                    <div class="row">
                        <div class="col-3"></div>
                        <div class="col-9"><strong style="font-size:18px;">List of Documents</strong></div>
                    </div>
                    <hr></hr>
                    <div class="row">
                        <div class="col-3"></div>
                        <div class="col-9"><a t-if="document_count &lt; 4" t-attf-class="btn btn-primary"
                                              href="/my/gdrive/create">Upload a Document</a></div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="gdrive_create">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Upload Your Documentation</t>
            <h3>Upload Your Documentation</h3>
            <form action="/my/gdrive/create" method="post" enctype="multipart/form-data">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <div class="row o_portal_details">
                    <div class="col-lg-8">
                        <div class="row">
                            <div class="col-lg-12">
                                <div t-if="error_message" class="alert alert-danger" role="alert">
                                    <t t-foreach="error_message" t-as="err"><t t-esc="err"/><br/></t>
                                </div>
                            </div>
                            <div t-attf-class="form-group col-xl-6">
                                <label class="col-form-label" for="document_id">Document Type</label>
                                <select name="document_id" t-attf-class="form-control ">
                                    <t t-foreach="documents_ids" t-as="document">
                                        <option t-att-value="document.id">
                                            <t t-esc="document.name"/>
                                        </option>
                                    </t>
                                </select>
                                <label class="col-form-label" for="file">Select a File</label>
                                <input type="file" name="file" class="file" multiple="true"
                                       data-show-upload="true"
                                       data-show-caption="true" lass="file"
                                       data-show-preview="true"
                                       id="file"
                                       accept=".jpg, .jpeg, .png, .pdf"/>
                            </div>
                            <!--                            <div t-attf-class="form-group #{error.get('filename') and 'o_has_error' or ''} col-xl-6">-->
                            <!--                                <input type="text" name="filename" t-attf-class="form-control #{error.get('filename') and 'is-invalid' or ''}" invisible="1" />-->
                            <!--                            </div>-->
                            <div t-attf-class="form-group col-xl-6">

                                <!--                                <button type="object" name="file" widget="binary" accept=".jpg, .jpeg, .png, .pdf" filename="filename" />-->
                            </div>
                            <input type="hidden" name="redirect" t-att-value="redirect"/>
                        </div>
                        <div class="clearfix">
                            <button type="submit" class="btn btn-primary float-right mb32 ">
                                Confirm
                                <span class="fa fa-long-arrow-right"/>
                            </button>
                            <a href="/my/gdrive/documents" type="button" class="btn btn-primary float-left mb32 ">
                                Back
                                <span class="fa fa-long-arrow-left"/>
                            </a>
                        </div>
                    </div>
                </div>
            </form>
        </t>

    </template>

    <template id="op_gdrive_update">
        <t t-call="portal.portal_layout">
            <t t-set="additional_title">Update Your Documentation</t>
            <h3>Update Your Documentation</h3>
            <form t-attf-action="/my/gdrive/update/{{ doc_id }}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <div class="row o_portal_details">
                    <div class="col-lg-8">
                        <div class="row">
                            <div class="col-lg-12">
                                <div t-if="error_message" class="alert alert-danger" role="alert">
                                    <t t-foreach="error_message" t-as="err"><t t-esc="err"/><br/></t>
                                </div>
                            </div>
                            <div t-attf-class="form-group col-xl-6">
                                <label class="col-form-label" for="document_id">Document Type</label>
                                <select name="document_id" t-attf-class="form-control " readonly="">
                                    <t t-foreach="document_type_id" t-as="document">
                                        <option t-att-value="document.id">
                                            <t t-esc="document.name"/>
                                        </option>
                                    </t>
                                </select>
                                <label class="col-form-label" for="file">Select a File</label>
                                <input type="file" name="file" class="file" multiple="true"
                                       data-show-upload="true"
                                       data-show-caption="true" lass="file"
                                       data-show-preview="true"
                                       id="file"
                                       accept=".jpg, .jpeg, .png, .pdf"/>
                            </div>
                            <!--                            <div t-attf-class="form-group #{error.get('filename') and 'o_has_error' or ''} col-xl-6">-->
                            <!--                                <input type="text" name="filename" t-attf-class="form-control #{error.get('filename') and 'is-invalid' or ''}" invisible="1" />-->
                            <!--                            </div>-->
                            <div t-attf-class="form-group col-xl-6">

                                <!--                                <button type="object" name="file" widget="binary" accept=".jpg, .jpeg, .png, .pdf" filename="filename" />-->
                            </div>
                            <input type="hidden" name="redirect" t-att-value="redirect"/>
                        </div>
                        <div class="clearfix">
                            <button type="submit" class="btn btn-primary float-right mb32 ">
                                Confirm
                                <span class="fa fa-long-arrow-right"/>
                            </button>
                            <a href="/my/gdrive/documents" type="button" class="btn btn-primary float-left mb32 ">
                                Back
                                <span class="fa fa-long-arrow-left"/>
                            </a>
                        </div>

                    </div>
                </div>
            </form>
        </t>

    </template>

    <template id="portal_documents_update">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Documentation</t>
            </t>
            <!--            <t t-set="additional_title">Update Your Documentation</t>-->
            <div class="card pb-5">
                <div>
                    <div id="introduction" class="pb-2 pt-3 card-header bg-white">
                        <h2>Update Your Documentation <em>DOC-<t
                                t-esc="document.document_type_id.name"/>-<span t-field="document.id"/></em></h2>
                    </div>
                    <div class="card-body">
                        <div id="informations" class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <strong>Upload date:</strong>
                                    <span t-field="document.create_date"/>
                                </div>
                                <div class="mb-3">
                                    <strong>Document name:</strong>
                                    <span t-field="document.document_name"/>
                                </div>
                                <div class="mb-3">
                                    <strong>Document type:</strong>
                                    <span t-field="document.document_type_id"/>
                                </div>
                            </div>
                            <div id="details" style="page-break-inside: auto;" class="col-md-6">
                                <form t-attf-action="/my/documents/update/{{ doc_id }}" method="post"
                                      enctype="multipart/form-data">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <div class="row">
                                        <div class="col-lg-12" t-if="error_message">
                                            <div t-if="error_message" class="alert alert-danger" role="alert">
                                                <t t-foreach="error_message" t-as="err"><t
                                                        t-esc="err"/><br/></t>
                                            </div>
                                        </div>
                                        <div t-attf-class="form-group col-md-11">
                                            <label class="col-form-label pt0" for="document_id">Document Type</label>
                                            <select name="document_id" t-attf-class="form-control " readonly="">
                                                <t t-foreach="document_type_id" t-as="document">
                                                    <option t-att-value="document.id">
                                                        <t t-esc="document.name"/>
                                                    </option>
                                                </t>
                                            </select>
                                            <label class="col-form-label mt8" for="file">Select a File</label>
                                            <input type="file" name="file" class="file" multiple="true"
                                                   data-show-upload="true"
                                                   data-show-caption="true" lass="file"
                                                   data-show-preview="true"
                                                   id="file"
                                                   accept=".jpg, .jpeg, .png, .pdf"/>
                                        </div>
                                        <input type="hidden" name="redirect" t-att-value="redirect"/>
                                    </div>
                                    <div class="clearfix mt8 p-3">
                                        <button type="submit" class="btn btn-primary float-right">
                                            Confirm<span class="fa fa-long-arrow-right"/>
                                        </button>
                                        <a href="/my/documents" type="button"
                                           class="btn btn-secondary float-left">
                                            Back<span class="fa fa-long-arrow-left"/>
                                        </a>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="portal_documents_create">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Upload documentation</t>
            </t>
            <t t-set="additional_title">Upload Documentation</t>
            <div class="card pb-2">
                <div id="introduction" class="pb-2 pt-3 card-header bg-white">
                    <h2>Upload Your Documentation</h2>
                </div>
                <div class="card-body">
                    <div style="page-break-inside: auto;" class="col-md-8 m-auto">
                        <form action="/my/documents/create" method="post" enctype="multipart/form-data">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div t-if="error_message" class="col-lg-12">
                                <div t-if="error_message" class="alert alert-danger" role="alert">
                                    <t t-foreach="error_message" t-as="err"><t t-esc="err"/><br/></t>
                                </div>
                            </div>
                            <div t-attf-class="form-group">
                                <label class="col-form-label" for="document_id">Document Type</label>
                                <select name="document_id" t-attf-class="form-control ">
                                    <t t-foreach="documents_ids" t-as="document">
                                        <option t-att-value="document.id">
                                            <t t-esc="document.name"/>
                                        </option>
                                    </t>
                                </select>
                                <label class="col-form-label" for="file">Select a File</label>
                                <input type="file" name="file" class="file" multiple="true"
                                       data-show-upload="true"
                                       data-show-caption="true" lass="file"
                                       data-show-preview="true"
                                       id="file"
                                       accept=".jpg, .jpeg, .png, .pdf"/>
                            </div>
                            <input type="hidden" name="redirect" t-att-value="redirect"/>
                            <div class="clearfix">
                                <button type="submit" class="btn btn-primary float-right mb32 ">
                                    Confirm<span class="fa fa-long-arrow-right"/>
                                </button>
                                <a href="/my/documents" type="button"
                                   class="btn btn-outline-secondary float-left mb32 ">
                                    Back<span class="fa fa-long-arrow-left"/>
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
